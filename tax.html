<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax Calculator with Payment</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
    <h1>Tax Calculator with Payment</h1>
    <label for="income">Income:</label>
    <input type="number" id="income" name="income" required>

    <label for="regime">Tax Regime:</label>
    <select id="regime">
        <option value="old">Old Regime</option>
        <option value="new">New Regime</option>
    </select>

    <button id="calculateBtn">Calculate Tax</button>

    <div id="result"></div>

    <button id="payNowBtn" style="display:none;">Pay Now</button>

    <script>
        document.getElementById('calculateBtn').addEventListener('click', async function() {
            const income = parseFloat(document.getElementById('income').value);
            const regime = document.getElementById('regime').value;

            let tax = 0;
            if (regime === 'old') {
                if (income <= 250000) {
                    tax = 0;
                } else if (income <= 500000) {
                    tax = (income - 250000) * 0.05;
                } else if (income <= 1000000) {
                    tax = 12500 + (income - 500000) * 0.1;
                } else if (income <= 1500000) {
                    tax = 87500 + (income - 1000000) * 0.15;
                } else if (income <= 2500000) {
                    tax = 187500 + (income - 1500000) * 0.2;
                } else {
                    tax = 387500 + (income - 2500000) * 0.25;
                }
            } else if (regime === 'new') {
                if (income <= 250000) {
                    tax = 0;
                } else if (income <= 500000) {
                    tax = (income - 250000) * 0.05;
                } else if (income <= 750000) {
                    tax = 12500 + (income - 500000) * 0.1;
                } else if (income <= 1000000) {
                    tax = 37500 + (income - 750000) * 0.15;
                } else if (income <= 1250000) {
                    tax = 75000 + (income - 1000000) * 0.2;
                } else if (income <= 1500000) {
                    tax = 125000 + (income - 1250000) * 0.25;
                } else if (income <= 1875000) {
                    tax = 187500 + (income - 1500000) * 0.3;
                } else if (income <= 2500000) {
                    tax = 312500 + (income - 1875000) * 0.35;
                } else {
                    tax = 562500 + (income - 2500000) * 0.3;
                }
            }

            document.getElementById('result').innerHTML = `
                <p>Tax to be paid: ${tax}</p>
            `;

            document.getElementById('payNowBtn').style.display = 'block';
            document.getElementById('payNowBtn').setAttribute('data-tax', tax);
        });

        document.getElementById('payNowBtn').addEventListener('click', async function() {
            const tax = parseFloat(this.getAttribute('data-tax'));

            const response = await fetch('/create-order', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ amount: tax })
            });

            const order = await response.json();

            const options = {
                key: rzp_test_xsjp7xtBmxjcHS, // Replace with your Razorpay API Key
                amount: order.amount,
                currency: order.currency,
                order_id: order.id,
                name: 'Tax Payment',
                description: 'Payment for Tax',
                handler: function (response) {
                    alert('Payment Successful');
                },
                prefill: {
                    name: 'John Doe',
                    email: 'john@example.com',
                    contact: '9999999999'
                }
            };

            const rzp = new Razorpay(options);
            rzp.open();
        });
    </script>
</body>
</html>
